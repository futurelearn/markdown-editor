{"version":3,"file":"markdown-editor.cjs.development.js","sources":["../src/Editor/schema.js","../src/Editor/markdown.ts","../src/Editor/Plugins/editor.ts","../src/Editor/Plugins/paste.ts","../src/Editor/utils/markInputRule.ts","../src/Editor/utils/linkInputRule.ts","../src/Editor/utils/markdownLinkInputRule.ts","../src/Editor/utils/markIsActive.ts","../src/Editor/utils/nodeIsActive.ts","../src/Editor/utils/toggleBlockType.ts","../src/Editor/utils/toggleWrap.ts","../src/Editor/utils/toggleList.ts","../src/Editor/Plugins/menu.ts","../src/Editor/Plugins/placeholder.ts","../src/Editor/Plugins/fileUpload.ts","../src/Editor/Plugins/imageDrop.ts","../src/Editor/Plugins/highlight.ts","../src/Editor/BaseType.ts","../src/Editor/Marks/Mark.ts","../src/Editor/Marks/Strong.ts","../src/Editor/Marks/Emphasis.ts","../src/Editor/Marks/InlineCode.ts","../src/Editor/Marks/Link.ts","../src/Editor/Marks/index.ts","../src/Editor/Nodes/Node.ts","../src/Editor/Nodes/Blockquote.ts","../src/Editor/Nodes/Heading.ts","../src/Editor/Nodes/BulletList.ts","../src/Editor/Nodes/OrderedList.ts","../src/Editor/Nodes/CodeBlock.ts","../src/Editor/Nodes/index.ts","../src/Toolbar/menuItems.ts","../src/Editor/View.ts","../src/Icons/Bold.tsx","../src/Icons/Code.tsx","../src/Icons/CodeBlock.tsx","../src/Icons/Heading.tsx","../src/Icons/Image.tsx","../src/Icons/Italic.tsx","../src/Icons/OrderedList.tsx","../src/Icons/Quote.tsx","../src/Icons/UnorderedList.tsx","../src/Icons/index.ts","../src/Toolbar/Item.tsx","../src/Toolbar/ImageUpload.tsx","../src/Toolbar/index.tsx","../src/ContextualHelp/index.tsx","../src/index.tsx"],"sourcesContent":["import { Schema } from 'prosemirror-model';\n\n// ::Schema Document schema for the data model used by CommonMark.\nexport default new Schema({\n  nodes: {\n    doc: {\n      content: 'block+',\n    },\n\n    paragraph: {\n      content: 'inline*',\n      group: 'block',\n      parseDOM: [{ tag: 'p' }],\n      toDOM() {\n        return ['p', 0];\n      },\n    },\n\n    blockquote: {\n      content: 'block+',\n      group: 'block',\n      parseDOM: [{ tag: 'blockquote' }],\n      toDOM() {\n        return ['blockquote', 0];\n      },\n    },\n\n    horizontal_rule: {\n      group: 'block',\n      parseDOM: [{ tag: 'hr' }],\n      toDOM() {\n        return ['div', ['hr']];\n      },\n    },\n\n    heading: {\n      attrs: { level: { default: 1 } },\n      content: 'inline*',\n      group: 'block',\n      defining: true,\n      parseDOM: [\n        { tag: 'h1', attrs: { level: 1 } },\n        { tag: 'h2', attrs: { level: 2 } },\n        { tag: 'h3', attrs: { level: 3 } },\n        { tag: 'h4', attrs: { level: 4 } },\n        { tag: 'h5', attrs: { level: 5 } },\n        { tag: 'h6', attrs: { level: 6 } },\n      ],\n      toDOM(node) {\n        return ['h' + node.attrs.level, 0];\n      },\n    },\n\n    code_block: {\n      content: 'text*',\n      group: 'block',\n      code: true,\n      isolating: true,\n      defining: true,\n      marks: '',\n      attrs: { params: { default: '' } },\n      parseDOM: [\n        {\n          tag: 'pre',\n          preserveWhitespace: 'full',\n          getAttrs: node => ({\n            params: node.getAttribute('data-params') || '',\n          }),\n        },\n      ],\n      toDOM(node) {\n        return [\n          'pre',\n          node.attrs.params ? { 'data-params': node.attrs.params } : {},\n          ['code', 0],\n        ];\n      },\n    },\n\n    ordered_list: {\n      content: 'list_item+',\n      group: 'block',\n      attrs: { order: { default: 1 }, tight: { default: false } },\n      parseDOM: [\n        {\n          tag: 'ol',\n          getAttrs(dom) {\n            return {\n              order: dom.hasAttribute('start') ? +dom.getAttribute('start') : 1,\n              tight: dom.hasAttribute('data-tight'),\n            };\n          },\n        },\n      ],\n      toDOM(node) {\n        return [\n          'ol',\n          {\n            start: node.attrs.order == 1 ? null : node.attrs.order,\n            'data-tight': node.attrs.tight ? 'true' : null,\n          },\n          0,\n        ];\n      },\n    },\n\n    bullet_list: {\n      content: 'list_item+',\n      group: 'block',\n      attrs: { tight: { default: false } },\n      parseDOM: [\n        {\n          tag: 'ul',\n          getAttrs: dom => ({ tight: dom.hasAttribute('data-tight') }),\n        },\n      ],\n      toDOM(node) {\n        return ['ul', { 'data-tight': node.attrs.tight ? 'true' : null }, 0];\n      },\n    },\n\n    list_item: {\n      content: 'paragraph block*',\n      defining: true,\n      parseDOM: [{ tag: 'li' }],\n      toDOM() {\n        return ['li', 0];\n      },\n    },\n\n    text: {\n      group: 'inline',\n    },\n\n    image: {\n      attrs: {\n        src: {},\n        alt: { default: null },\n        title: { default: null },\n      },\n      group: 'block',\n      draggable: true,\n      parseDOM: [\n        {\n          tag: 'p[data-img]',\n          getAttrs(dom) {\n            const image = dom.querySelector('img[src]');\n            return {\n              src: image.getAttribute('src'),\n              title: image.getAttribute('title'),\n              alt: image.getAttribute('alt'),\n            };\n          },\n        },\n      ],\n      toDOM(node) {\n        return ['p', { 'data-img': true }, ['img', node.attrs]];\n      },\n    },\n\n    hard_break: {\n      inline: true,\n      group: 'inline',\n      selectable: false,\n      parseDOM: [{ tag: 'br' }],\n      toDOM() {\n        return ['br'];\n      },\n    },\n  },\n\n  marks: {\n    em: {\n      parseDOM: [\n        { tag: 'i' },\n        { tag: 'em' },\n        { style: 'font-style', getAttrs: value => value == 'italic' && null },\n      ],\n      toDOM() {\n        return ['em'];\n      },\n    },\n\n    strong: {\n      parseDOM: [\n        { tag: 'b' },\n        { tag: 'strong' },\n        {\n          style: 'font-weight',\n          getAttrs: value => /^(bold(er)?|[5-9]\\d{2,})$/.test(value) && null,\n        },\n      ],\n      toDOM() {\n        return ['strong'];\n      },\n    },\n\n    link: {\n      attrs: {\n        href: {},\n        title: { default: null },\n      },\n      inclusive: false,\n      parseDOM: [\n        {\n          tag: 'a[href]',\n          getAttrs(dom) {\n            return {\n              href: dom.getAttribute('href'),\n              title: dom.getAttribute('title'),\n            };\n          },\n        },\n      ],\n      toDOM(node) {\n        return ['a', node.attrs];\n      },\n    },\n\n    code: {\n      parseDOM: [{ tag: 'code' }],\n      toDOM() {\n        return ['code'];\n      },\n    },\n  },\n});\n","import {\n  defaultMarkdownParser as initialDefaultMarkdownParser,\n  defaultMarkdownSerializer as initialDefaultMarkdownSerializer,\n  MarkdownParser,\n} from 'prosemirror-markdown';\n//@ts-ignore\nimport initialSchema from './schema';\nimport { Schema, Mark } from 'prosemirror-model';\nimport { omit, compact } from 'lodash';\nimport markdownit from 'markdown-it/lib';\n\nexport interface MarkdownSchema extends Schema {\n  disabledNodes: string[];\n  disabledMarks: string[];\n}\n\ndeclare module 'prosemirror-markdown' {\n  let schema: MarkdownSchema;\n}\n\nconst IGNORED_NODES = ['horizontal_rule', 'hard_break'];\nconst IGNORED_TOKENS = ['hr', 'hardbreak'];\nconst MARKDOWN_IT_RULES: { [token: string]: string } = {\n  code: 'backticks',\n  heading: 'heading',\n  blockquote: 'blockquote',\n  code_block: 'code',\n  fence: 'fence',\n  bullet_list: 'list',\n  ordered_list: 'list',\n  hr: 'hr',\n  image: 'image',\n  link: 'link',\n};\n\nconst setupSchema = ({\n  disabledMarks = [],\n  disabledNodes = [],\n}: {\n  disabledMarks?: string[];\n  disabledNodes?: string[];\n}) => {\n  if (disabledNodes.includes('code_block')) {\n    disabledNodes.push('fence');\n  }\n\n  initialSchema.nodes = omit(initialSchema.nodes, [\n    ...IGNORED_NODES,\n    ...disabledNodes,\n  ]);\n  initialSchema.marks = omit(initialSchema.marks, disabledMarks);\n\n  initialSchema.disabledNodes = disabledNodes;\n  initialSchema.disabledMarks = disabledMarks;\n\n  return initialSchema;\n};\n\nconst defaultMarkdownParser = (schema: MarkdownSchema) => {\n  const disabledTokens = [\n    ...IGNORED_TOKENS,\n    ...schema.disabledNodes,\n    ...schema.disabledMarks,\n  ];\n  const tokens = omit(initialDefaultMarkdownParser.tokens, disabledTokens);\n\n  const md = markdownit('commonmark', { html: false });\n  const tokensToDisable = compact(\n    disabledTokens.map(t => MARKDOWN_IT_RULES[t])\n  );\n  md.disable(tokensToDisable);\n\n  //@ts-ignore\n  const parser =  new MarkdownParser(schema, md, tokens);\n  parser.tokenHandlers.paragraph_close = (state: any) => {\n    if (state.marks.length) { state.marks = Mark.none; }\n    const info = state.stack.pop();\n    const node = info.type.create(info.attrs, info.content, state.marks);\n    state.push(node);\n    return node;\n  }\n\n  return parser;\n};\n\nconst defaultMarkdownSerializer = (() => {\n  initialDefaultMarkdownSerializer.nodes.code_block = (state, node) => {\n    state.write('~~~' + (node.attrs.params || '') + '\\n');\n    state.text(node.textContent, false);\n    state.ensureNewLine();\n    state.write('~~~');\n    state.closeBlock(node);\n  };\n  return initialDefaultMarkdownSerializer;\n})();\n\nexport { setupSchema, defaultMarkdownParser, defaultMarkdownSerializer };\n","import { Plugin } from 'prosemirror-state';\n\nconst EDITOR_CLASS = 'rich-text-editor';\n\nexport const editorPlugin = (classes: string, placeholder: string) =>\n  new Plugin({\n    props: {\n      attributes: {\n        class: classes.length ? `${EDITOR_CLASS} ${classes}` : EDITOR_CLASS,\n        'data-placeholder': placeholder,\n      },\n    },\n  });\n","import { Plugin } from 'prosemirror-state';\nimport { Slice } from 'prosemirror-model';\nimport { defaultMarkdownParser, MarkdownSchema } from '../markdown';\n\nexport const pastePlugin = (\n  schema: MarkdownSchema,\n  onError: (errors: string) => any\n) =>\n  new Plugin({\n    props: {\n      clipboardTextParser: text => {\n        const fragment = defaultMarkdownParser(schema).parse(text).content;\n        return Slice.maxOpen(fragment);\n      },\n      transformPastedHTML: html => {\n        if (html.includes('<img src')) {\n          onError('Pasted content cannot contain images');\n          return '';\n        }\n\n        return html;\n      },\n    },\n  });\n","import { InputRule } from 'prosemirror-inputrules';\nimport { MarkType } from 'prosemirror-model';\nimport { EditorState } from 'prosemirror-state';\nimport { MarkBetween } from '../../types';\n\nconst getMarksBetween = (start: number, end: number, state: EditorState) => {\n  let marks: MarkBetween[] = [];\n\n  state.doc.nodesBetween(start, end, (node, pos) => {\n    marks = [\n      ...marks,\n      ...node.marks.map(mark => ({\n        start: pos,\n        end: pos + node.nodeSize,\n        mark,\n      })),\n    ];\n  });\n\n  return marks;\n};\n\nexport const markInputRule = function(\n  regexp: RegExp,\n  markType: MarkType,\n  getAttrs?: any\n): InputRule {\n  return new InputRule(regexp, (state, match, start, end) => {\n    const attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs;\n    const { tr } = state;\n    const m = match.length - 1;\n    let markEnd = end;\n    let markStart = start;\n\n    if (match[m]) {\n      const matchStart = start + match[0].indexOf(match[m - 1]);\n      const matchEnd = matchStart + match[m - 1].length - 1;\n      const textStart = matchStart + match[m - 1].lastIndexOf(match[m]);\n      const textEnd = textStart + match[m].length;\n\n      const excludedMarks = getMarksBetween(start, end, state)\n        .filter(item => item.mark.type.excludes(markType))\n        .filter(item => item.end > matchStart);\n\n      if (excludedMarks.length) {\n        return null;\n      }\n\n      if (textEnd < matchEnd) {\n        tr.delete(textEnd, matchEnd);\n      }\n      if (textStart > matchStart) {\n        tr.delete(matchStart, textStart);\n      }\n      markStart = matchStart;\n      markEnd = markStart + match[m].length;\n    }\n\n    tr.addMark(markStart, markEnd, markType.create(attrs));\n    tr.removeStoredMark(markType);\n    return tr;\n  });\n};\n","import { InputRule } from 'prosemirror-inputrules';\nimport { MarkType } from 'prosemirror-model';\n\nexport const linkInputRule = function(regexp: RegExp, markType: MarkType) {\n  return new InputRule(regexp, (state, match, start, end) => {\n    const tr = state.tr.insertText(match[0], start, end);\n    const mark = markType.create({ href: match[1] });\n    return tr.addMark(start, start + match[1].length, mark);\n  });\n};\n","import { InputRule } from 'prosemirror-inputrules';\nimport { MarkType } from 'prosemirror-model';\n\nexport const markdownLinkInputRule = function(\n  regexp: RegExp,\n  markType: MarkType\n) {\n  return new InputRule(regexp, (state, match, start, end) => {\n    const tr = state.tr.insertText(match[1], start, end);\n    const mark = markType.create({ href: match[2], title: match[3] });\n    return tr.addMark(start, start + match[1].length, mark);\n  });\n};\n","import { EditorState } from 'prosemirror-state';\nimport { MarkType } from 'prosemirror-model';\n\nexport const markIsActive = function(state: EditorState, type: MarkType) {\n  const { from, $from, to, empty } = state.selection;\n\n  if (empty) {\n    return !!type.isInSet(state.storedMarks || $from.marks());\n  }\n\n  return !!state.doc.rangeHasMark(from, to, type);\n};\n","import { findParentNode, findSelectedNodeOfType } from 'prosemirror-utils';\nimport { EditorState } from 'prosemirror-state';\nimport { NodeType, Node } from 'prosemirror-model';\n\nexport const nodeIsActive = function(\n  state: EditorState,\n  type: NodeType,\n  attrs = {}\n) {\n  const predicate = (node: Node) => node.type === type;\n  const node =\n    findSelectedNodeOfType(type)(state.selection) ||\n    findParentNode(predicate)(state.selection);\n\n  if (!Object.keys(attrs).length || !node) {\n    return {\n      isActive: !!node,\n      node: node?.node,\n    };\n  }\n\n  return {\n    isActive: node.node.hasMarkup(type),\n    node: node.node,\n  };\n};\n","import { setBlockType } from 'prosemirror-commands';\nimport { NodeType } from 'prosemirror-model';\nimport { EditorState } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport { nodeIsActive } from './nodeIsActive';\n\nexport const toggleBlockType = function(\n  type: NodeType,\n  toggletype: NodeType,\n  attrs = {}\n) {\n  return (state: EditorState, dispatch: EditorView['dispatch']) => {\n    const { isActive } = nodeIsActive(state, type, attrs);\n\n    if (isActive) {\n      return setBlockType(toggletype)(state, dispatch);\n    }\n\n    return setBlockType(type, attrs)(state, dispatch);\n  };\n};\n","import { wrapIn, lift } from 'prosemirror-commands';\nimport { NodeType } from 'prosemirror-model';\nimport { nodeIsActive } from './nodeIsActive';\nimport { EditorState } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\n\nexport const toggleWrap = function(type: NodeType) {\n  return (state: EditorState, dispatch: EditorView['dispatch']) => {\n    const { isActive } = nodeIsActive(state, type);\n\n    if (isActive) {\n      return lift(state, dispatch);\n    }\n\n    return wrapIn(type)(state, dispatch);\n  };\n};\n","import { wrapInList, liftListItem } from 'prosemirror-schema-list';\nimport { findParentNode } from 'prosemirror-utils';\nimport { EditorState } from 'prosemirror-state';\nimport { NodeType, Node, Schema } from 'prosemirror-model';\nimport { EditorView } from 'prosemirror-view';\n\nconst isList = (node: Node, schema: Schema) =>\n  node.type === schema.nodes.bullet_list ||\n  node.type === schema.nodes.ordered_list ||\n  node.type === schema.nodes.todo_list;\n\nexport const toggleList = function toggleList(\n  listType: NodeType,\n  itemType: NodeType\n) {\n  return (state: EditorState, dispatch: EditorView['dispatch']) => {\n    const { schema, selection } = state;\n    const { $from, $to } = selection;\n    const range = $from.blockRange($to);\n\n    if (!range) {\n      return false;\n    }\n\n    const parentList = findParentNode(node => isList(node, schema))(selection);\n\n    if (range.depth >= 1 && parentList && range.depth - parentList.depth <= 1) {\n      if (parentList.node.type === listType) {\n        return liftListItem(itemType)(state, dispatch);\n      }\n\n      if (\n        isList(parentList.node, schema) &&\n        listType.validContent(parentList.node.content)\n      ) {\n        const { tr } = state;\n        tr.setNodeMarkup(parentList.pos, listType);\n\n        if (dispatch) {\n          dispatch(tr);\n        }\n\n        return false;\n      }\n    }\n\n    return wrapInList(listType)(state, dispatch);\n  };\n};\n","import { MenuItem } from '../../types';\nimport { MarkType, NodeType } from 'prosemirror-model';\nimport { EditorView } from 'prosemirror-view';\nimport { Plugin } from 'prosemirror-state';\nimport { nodeIsActive, markIsActive } from '../utils';\n\nclass Menu {\n  items: MenuItem[];\n  editorView: EditorView;\n  onUpdate: (items: string[]) => any;\n\n  constructor(\n    items: MenuItem[],\n    editorView: EditorView,\n    onUpdate: (items: string[]) => any\n  ) {\n    this.items = items;\n    this.editorView = editorView;\n    this.onUpdate = onUpdate;\n  }\n\n  markActive(type: MarkType | NodeType): boolean {\n    const { state } = this.editorView;\n\n    if (type instanceof NodeType) {\n      return nodeIsActive(state, type).isActive;\n    }\n\n    return markIsActive(state, type);\n  }\n\n  update() {\n    const activeItems = this.items.filter(item => this.markActive(item.type));\n    if (activeItems.length) {\n      this.onUpdate(activeItems.map(i => i.name));\n    } else {\n      this.onUpdate([]);\n    }\n  }\n\n  destroy() {\n    this.onUpdate([]);\n  }\n}\n\nexport const menuPlugin = (\n  items: MenuItem[],\n  onUpdate: (items: string[]) => any\n) =>\n  new Plugin({\n    view: editorView => new Menu(items, editorView, onUpdate),\n  });\n","import { Plugin } from 'prosemirror-state';\nimport { Decoration, DecorationSet } from 'prosemirror-view';\nimport { EditorState } from 'prosemirror-state';\n\nexport const placeholderPlugin = new Plugin({\n  state: {\n    init() {\n      return DecorationSet.empty;\n    },\n    apply(this: Plugin, tr, set: DecorationSet) {\n      // Adjust decoration positions to changes made by the transaction\n      set = set.map(tr.mapping, tr.doc);\n      // See if the transaction adds or removes any placeholders\n      let action = tr.getMeta(this);\n      if (action && action.add) {\n        let widget = document.createElement('div');\n        widget.className = 'image__placeholder';\n        let loader = document.createElement('div');\n        loader.className = 'loader';\n        widget.appendChild(loader);\n        let deco = Decoration.widget(action.add.pos, widget, {\n          id: action.add.id,\n        });\n        set = set.add(tr.doc, [deco]);\n      } else if (action && action.remove) {\n        set = set.remove(\n          set.find(undefined, undefined, spec => spec.id === action.remove.id)\n        );\n      }\n      return set;\n    },\n  },\n  props: {\n    decorations(this: Plugin, state) {\n      return this.getState(state);\n    },\n  },\n});\n\nexport const findPlaceholder = function(state: EditorState, id: {}) {\n  let decos = placeholderPlugin.getState(state);\n  let found = decos.find(undefined, undefined, spec => spec.id === id);\n  return found.length ? found[0].from : null;\n};\n","import { placeholderPlugin, findPlaceholder } from './placeholder';\nimport { EditorView } from 'prosemirror-view';\n\nexport const fileUpload = (\n  view: EditorView,\n  images: File[],\n  endpoint: { url: string; csrfToken: string },\n  position: number,\n  onError: (errors: string) => any\n): boolean => {\n  let id = {};\n  const confirmResult = window.confirm('I am authorised to use this content');\n  if (!confirmResult) {\n    return false;\n  }\n\n  const tr = view.state.tr;\n  tr.setMeta(placeholderPlugin, { add: { id, pos: position } });\n  tr.setSelection(tr.selection);\n  view.dispatch(tr);\n  const { schema } = view.state;\n\n  images.forEach(image => {\n    const pos = findPlaceholder(view.state, id);\n    if (!pos) return;\n    const formData = new FormData();\n    formData.append('image', image);\n    const xhr = new XMLHttpRequest();\n    xhr.withCredentials = true;\n    xhr.open('POST', endpoint.url, true);\n    xhr.setRequestHeader('X-CSRF-TOKEN', endpoint.csrfToken);\n    xhr.onerror = () => {\n      const transaction = view.state.tr.setMeta(placeholderPlugin, {\n        remove: { id },\n      });\n      onError('Sorry something went wrong');\n      view.dispatch(transaction);\n    };\n\n    xhr.onload = () => {\n      let transaction;\n      let jsonBody;\n      try {\n        jsonBody = JSON.parse(xhr.response);\n      } catch {\n        jsonBody = { errors: 'Sorry something went wrong' };\n      }\n      if ([200, 201].includes(xhr.status)) {\n        const node = schema.nodes.image.create({\n          src: jsonBody.data.url,\n        });\n\n        transaction = view.state.tr\n          .replaceWith(pos, pos, node)\n          .setMeta(placeholderPlugin, { remove: { id } });\n      } else {\n        transaction = view.state.tr.setMeta(placeholderPlugin, {\n          remove: { id },\n        });\n        onError(jsonBody.errors);\n      }\n      view.dispatch(transaction);\n    };\n    xhr.send(formData);\n  });\n\n  return true;\n};\n","import { Plugin } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport { fileUpload } from './fileUpload';\n\nexport const imageDropPlugin = (\n  endpoint: { url: string; csrfToken: string },\n  onError: (errors: string) => any\n) =>\n  new Plugin({\n    props: {\n      handleDOMEvents: {\n        drop(view: EditorView, event: Event) {\n          const dragEvent = event as DragEvent;\n          if (!dragEvent.dataTransfer) return false;\n          const hasFiles =\n            dragEvent.dataTransfer.files && dragEvent.dataTransfer.files.length;\n          if (!hasFiles) {\n            return false;\n          }\n\n          const images = Array.from(dragEvent.dataTransfer.files).filter(file =>\n            /image/i.test(file.type)\n          );\n\n          if (images.length === 0) {\n            return false;\n          }\n\n          event.preventDefault();\n\n          const coordinates = view.posAtCoords({\n            left: dragEvent.clientX,\n            top: dragEvent.clientY,\n          });\n\n          if (!coordinates) return false;\n\n          return fileUpload(view, images, endpoint, coordinates.pos, onError);\n        },\n      },\n    },\n  });\n","import { Decoration, DecorationSet } from 'prosemirror-view';\nimport { Node } from 'prosemirror-model';\nimport { Language } from '../../types';\nimport low from 'lowlight/lib/core';\nimport { Plugin, PluginKey } from 'prosemirror-state';\nimport { findBlockNodes } from 'prosemirror-utils';\nimport { flattenDeep } from 'lodash';\n\n//@ts-ignore\nimport javascript from 'highlight.js/lib/languages/javascript';\n//@ts-ignore\nimport python from 'highlight.js/lib/languages/python';\n//@ts-ignore\nimport r from 'highlight.js/lib/languages/r';\n//@ts-ignore\nimport css from 'highlight.js/lib/languages/css';\n//@ts-ignore\nimport java from 'highlight.js/lib/languages/java';\n\nfunction getDecorations({ doc, name }: { doc: Node; name: string }) {\n  const decorations: Decoration[] = [];\n  const languages: Language[] = [];\n  const blocks = findBlockNodes(doc).filter(\n    item => item.node.type.name === name\n  );\n\n  function parseNodes(nodes: lowlight.HastNode[], className = []) {\n    return nodes.map(node => {\n      const classes = [\n        ...className,\n        //@ts-ignore\n        ...(node.properties ? node.properties.className : []),\n      ];\n\n      //@ts-ignore\n      if (node.children) {\n        //@ts-ignore\n        return parseNodes(node.children, classes);\n      }\n\n      return {\n        //@ts-ignore\n        text: node.value,\n        classes,\n      };\n    });\n  }\n\n  blocks.forEach(block => {\n    let startPos = block.pos + 1;\n    const { value: nodes, language, relevance } = low.highlightAuto(\n      block.node.textContent\n    );\n\n    if (relevance > 1) {\n      if (language && language !== block.node.attrs.params) {\n        languages.push({ language, pos: block.pos, type: block.node.type });\n      }\n\n      flattenDeep(parseNodes(nodes))\n        .map(node => {\n          const from = startPos;\n          const to = from + node.text.length;\n\n          startPos = to;\n\n          return {\n            ...node,\n            from,\n            to,\n          };\n        })\n        .forEach(node => {\n          const decoration = Decoration.inline(node.from, node.to, {\n            class: node.classes.join(' '),\n          });\n          decorations.push(decoration);\n        });\n    }\n  });\n\n  return { decorations: DecorationSet.create(doc, decorations), languages };\n}\n\nexport const highlightPlugin = ({ name }: { name: string }) => {\n  low.registerLanguage('javascript', javascript);\n  low.registerLanguage('python', python);\n  low.registerLanguage('r', r);\n  low.registerLanguage('css', css);\n  low.registerLanguage('java', java);\n  const key = new PluginKey('highlight');\n  return new Plugin({\n    key,\n    state: {\n      init: (_, { doc }) => getDecorations({ doc, name }),\n      apply: (transaction, decorationSet, oldState, state) => {\n        const nodeName = state.selection.$head.parent.type.name;\n        const previousNodeName = oldState.selection.$head.parent.type.name;\n\n        if (\n          transaction.docChanged &&\n          [nodeName, previousNodeName].includes(name)\n        ) {\n          return getDecorations({ doc: transaction.doc, name });\n        }\n\n        const decorations = decorationSet.decorations || decorationSet;\n        return decorations.map(transaction.mapping, transaction.doc);\n      },\n    },\n    props: {\n      decorations(this: Plugin, state) {\n        const decorationSet = this.getState(state);\n        return decorationSet.decorations || decorationSet;\n      },\n    },\n    view: _view => {\n      return {\n        update: (view, prevState) => {\n          const highlight = key.get(prevState);\n          if (highlight) {\n            const { languages } = highlight.getState(prevState) as {\n              languages: Language[];\n            };\n            if (languages && languages.length) {\n              languages.forEach(lang => {\n                const transaction = view.state.tr.setNodeMarkup(\n                  lang.pos,\n                  lang.type,\n                  { params: lang.language }\n                );\n                view.dispatch(transaction);\n              });\n            }\n          }\n        },\n      };\n    },\n  });\n};\n","import { Schema, MarkType, NodeType } from 'prosemirror-model';\nimport { keymap } from 'prosemirror-keymap';\nimport { inputRules, InputRule } from 'prosemirror-inputrules';\n\nclass BaseType {\n  schema: Schema;\n  constructor(schema: Schema) {\n    this.schema = schema;\n  }\n\n  get name() {\n    return '';\n  }\n\n  get icon() {\n    return '';\n  }\n\n  get inToolbar() {\n    return true;\n  }\n\n  get command() {\n    return (_state: any, _dispatch: any) => {};\n  }\n\n  get shortcuts() {\n    return {};\n  }\n\n  get rules() {\n    return [] as InputRule[];\n  }\n\n  get type(): MarkType | NodeType | null {\n    return this._type;\n  }\n\n  protected get _type(): MarkType | NodeType | null {\n    return null;\n  }\n\n  getPlugins() {\n    if (this._type) {\n      return [keymap(this.shortcuts), inputRules({ rules: this.rules })];\n    }\n\n    return [];\n  }\n\n  getToolbarItem() {\n    if (this._type && this.inToolbar && this.command) {\n      return {\n        name: this.name,\n        icon: this.icon,\n        command: this.command,\n        type: this.type,\n      };\n    }\n\n    return null;\n  }\n}\n\nexport default BaseType;\n","import { MarkType } from 'prosemirror-model';\nimport BaseType from '../BaseType';\n\nclass Mark extends BaseType {\n  get type(): MarkType {\n    return this._type as MarkType;\n  }\n\n  protected get _type() {\n    return this.schema.marks[this.name];\n  }\n}\n\nexport default Mark;\n","import { toggleMark } from 'prosemirror-commands';\nimport { markInputRule } from '../utils';\nimport Mark from './Mark';\n\nclass Strong extends Mark {\n  get name() {\n    return 'strong';\n  }\n\n  get icon() {\n    return 'Bold';\n  }\n\n  get command() {\n    return toggleMark(this.type);\n  }\n\n  get shortcuts() {\n    return {\n      'Mod-b': toggleMark(this.type),\n      'Mod-B': toggleMark(this.type),\n    };\n  }\n\n  get rules() {\n    return [markInputRule(/(?:\\*\\*|__)([^*_]+)(?:\\*\\*|__)$/, this.type)];\n  }\n}\n\nexport default Strong;\n","import { toggleMark } from 'prosemirror-commands';\nimport { markInputRule } from '../utils';\nimport Mark from './Mark';\n\nclass Emphasis extends Mark {\n  get name() {\n    return 'em';\n  }\n\n  get icon() {\n    return 'Italic';\n  }\n\n  get shortcuts() {\n    return {\n      'Mod-i': toggleMark(this.type),\n      'Mod-I': toggleMark(this.type),\n    };\n  }\n\n  get rules() {\n    return [\n      markInputRule(/(?:^|[^_])(_([^_]+)_)$/, this.type),\n      markInputRule(/(?:^|[^*])(\\*([^*]+)\\*)$/, this.type),\n    ];\n  }\n\n  get command() {\n    return toggleMark(this.type);\n  }\n}\n\nexport default Emphasis;\n","import { toggleMark } from 'prosemirror-commands';\nimport { markInputRule } from '../utils';\nimport Mark from './Mark';\n\nclass InlineCode extends Mark {\n  get name() {\n    return 'code';\n  }\n\n  get icon() {\n    return 'Code';\n  }\n\n  get shortcuts() {\n    return {\n      'Mod-`': toggleMark(this.type),\n    };\n  }\n\n  get rules() {\n    return [markInputRule(/(?:`)([^`]+)(?:`)$/, this.type)];\n  }\n\n  get command() {\n    return toggleMark(this.type);\n  }\n}\n\nexport default InlineCode;\n","import { linkInputRule, markdownLinkInputRule } from '../utils';\nimport Mark from './Mark';\n\nconst URL_REGEX = /(https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\\\+.~#?&//=]*))\\s$/g;\nconst MARKDOWN_URL_REGX = /\\[(.+)\\]\\((https?[^ ]+)(?: \"(.+)\")?\\)$/;\n\nclass Link extends Mark {\n  get name() {\n    return 'link';\n  }\n\n  get rules() {\n    return [\n      linkInputRule(URL_REGEX, this.type),\n      markdownLinkInputRule(MARKDOWN_URL_REGX, this.type),\n    ];\n  }\n\n  get inToolbar() {\n    return false;\n  }\n}\n\nexport default Link;\n","import Strong from './Strong';\nimport Emphasis from './Emphasis';\nimport InlineCode from './InlineCode';\nimport Link from './Link';\nimport { flatMap, compact } from 'lodash';\nimport { Schema } from 'prosemirror-model';\n\nconst MARKS = [Strong, Emphasis, InlineCode, Link];\n\nexport const plugins = (schema: Schema) => {\n  return flatMap(MARKS, Mark => new Mark(schema).getPlugins());\n};\n\nexport const toolbarItems = (schema: Schema) => {\n  return compact(MARKS.map(Mark => new Mark(schema).getToolbarItem()));\n};\n","import { NodeType } from 'prosemirror-model';\nimport BaseType from '../BaseType';\n\nclass Node extends BaseType {\n  get type(): NodeType {\n    return this._type as NodeType;\n  }\n\n  protected get _type() {\n    return this.schema.nodes[this.name];\n  }\n\n  get paragraphType() {\n    return this.schema.nodes.paragraph;\n  }\n\n  get listItemType() {\n    return this.schema.nodes.list_item;\n  }\n}\n\nexport default Node;\n","import { wrappingInputRule } from 'prosemirror-inputrules';\nimport { toggleWrap } from '../utils';\nimport Node from './Node';\n\nclass Blockquote extends Node {\n  get name() {\n    return 'blockquote';\n  }\n\n  get icon() {\n    return 'Quote';\n  }\n\n  get command() {\n    return toggleWrap(this.type);\n  }\n\n  get rules() {\n    return [wrappingInputRule(/^\\s*>\\s$/, this.type)];\n  }\n}\n\nexport default Blockquote;\n","import { textblockTypeInputRule } from 'prosemirror-inputrules';\nimport { toggleBlockType } from '../utils';\nimport Node from './Node';\n\nconst LEVELS = [1, 2, 3, 4, 5, 6];\n\nclass Heading extends Node {\n  get name() {\n    return 'heading';\n  }\n\n  get icon() {\n    return 'Heading';\n  }\n\n  get command() {\n    return toggleBlockType(this.type, this.paragraphType, this.schema);\n  }\n\n  get rules() {\n    return LEVELS.map(l =>\n      textblockTypeInputRule(new RegExp(`^(#{1,${l}})\\\\s$`), this.type, () => ({\n        level: l,\n      }))\n    );\n  }\n}\n\nexport default Heading;\n","import { wrappingInputRule } from 'prosemirror-inputrules';\nimport { toggleList } from '../utils';\nimport Node from './Node';\n\nclass BulletList extends Node {\n  get name() {\n    return 'bullet_list';\n  }\n\n  get icon() {\n    return 'UnorderedList';\n  }\n\n  get command() {\n    return toggleList(this.type, this.listItemType);\n  }\n\n  get rules() {\n    return [wrappingInputRule(/^\\s*([-+*])\\s$/, this.type)];\n  }\n}\n\nexport default BulletList;\n","import { wrappingInputRule } from 'prosemirror-inputrules';\nimport { toggleList } from '../utils';\nimport Node from './Node';\n\nclass OrderedList extends Node {\n  get name() {\n    return 'ordered_list';\n  }\n\n  get icon() {\n    return 'OrderedList';\n  }\n\n  get command() {\n    return toggleList(this.type, this.listItemType);\n  }\n\n  get rules() {\n    return [\n      wrappingInputRule(\n        /^(\\d+)\\.\\s$/,\n        this.type,\n        match => ({ order: +match[1] }),\n        (match, node) => node.childCount + node.attrs.order === +match[1]\n      ),\n    ];\n  }\n}\n\nexport default OrderedList;\n","import { textblockTypeInputRule } from 'prosemirror-inputrules';\nimport { toggleBlockType } from '../utils';\nimport Node from './Node';\n\nclass CodeBlock extends Node {\n  get name() {\n    return 'code_block';\n  }\n\n  get icon() {\n    return 'CodeBlock';\n  }\n\n  get command() {\n    return toggleBlockType(this.type, this.paragraphType, this.schema);\n  }\n\n  get rules() {\n    return [textblockTypeInputRule(/^(```|~~~)$/, this.type)];\n  }\n}\n\nexport default CodeBlock;\n","import Blockquote from './Blockquote';\nimport Heading from './Heading';\nimport BulletList from './BulletList';\nimport OrderedList from './OrderedList';\nimport CodeBlock from './CodeBlock';\nimport { flatMap, compact } from 'lodash';\nimport { Schema } from 'prosemirror-model';\n\nconst NODES = [Blockquote, Heading, BulletList, OrderedList, CodeBlock];\n\nexport const plugins = (schema: Schema) => {\n  return flatMap(NODES, Node => new Node(schema).getPlugins());\n};\n\nexport const toolbarItems = (schema: Schema) => {\n  return compact(NODES.map(Node => new Node(schema).getToolbarItem()));\n};\n","import { MenuItem } from '../types';\nimport { toolbarItems as markToolbarItems } from '../Editor/Marks';\nimport { toolbarItems as nodeToolbarItems } from '../Editor/Nodes';\nimport { Schema } from 'prosemirror-model';\n\nconst menuItems = (schema: Schema) =>\n  [...markToolbarItems(schema), ...nodeToolbarItems(schema)] as MenuItem[];\n\nexport default menuItems;\n","import { CreateEditorViewOptions } from '../types';\nimport { EditorView } from 'prosemirror-view';\nimport { EditorState, Transaction } from 'prosemirror-state';\nimport {\n  defaultMarkdownParser,\n  defaultMarkdownSerializer,\n  setupSchema,\n} from './markdown';\nimport { keymap } from 'prosemirror-keymap';\nimport { baseKeymap, exitCode, setBlockType } from 'prosemirror-commands';\nimport { history, undo, redo } from 'prosemirror-history';\nimport { splitListItem } from 'prosemirror-schema-list';\nimport {\n  editorPlugin,\n  pastePlugin,\n  menuPlugin,\n  imageDropPlugin,\n  placeholderPlugin,\n  highlightPlugin,\n} from './Plugins';\nimport toolbarItems from '../Toolbar/menuItems';\nimport { plugins as markPlugins } from './Marks';\nimport { plugins as nodePlugins } from './Nodes';\n\nconst createEditorView = ({\n  node,\n  value,\n  onChange,\n  classes,\n  placeholder,\n  onToolbarChange,\n  imageUploadEndpoint,\n  disabledMarks,\n  disabledNodes,\n  onError,\n}: CreateEditorViewOptions): EditorView => {\n  const schema = setupSchema({ disabledMarks, disabledNodes });\n  const LIST_ITEM_TYPE = schema.nodes.list_item;\n  const toggleBlockIfEmpty = (\n    state: EditorState,\n    dispatch: EditorView['dispatch']\n  ) => {\n    let {\n      $from: { parent },\n    } = state.selection;\n    if ([schema.nodes.heading, schema.nodes.code_block].includes(parent.type)) {\n      if (!parent.textContent.length) {\n        setBlockType(schema.nodes.paragraph)(state, dispatch);\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  const plugins = [\n    history(),\n    keymap({\n      'Mod-z': undo,\n      'Mod-y': redo,\n      Enter: splitListItem(LIST_ITEM_TYPE),\n      Backspace: toggleBlockIfEmpty,\n    }),\n    keymap({\n      'Shift-Enter': exitCode,\n    }),\n    keymap(baseKeymap),\n    pastePlugin(schema, onError),\n    menuPlugin(toolbarItems(schema), onToolbarChange),\n    ...markPlugins(schema),\n    ...nodePlugins(schema),\n    editorPlugin(classes, placeholder),\n  ];\n\n  schema.nodes.code_block &&\n    plugins.push(highlightPlugin({ name: schema.nodes.code_block.name }));\n\n  imageUploadEndpoint &&\n    schema.nodes.image &&\n    plugins.push(\n      placeholderPlugin,\n      imageDropPlugin(imageUploadEndpoint, onError)\n    );\n\n  const editorView = new EditorView(node, {\n    state: EditorState.create({\n      schema,\n      doc: defaultMarkdownParser(schema).parse(value),\n      plugins,\n    }),\n    dispatchTransaction(transation: Transaction) {\n      const newState = editorView.state.apply(transation);\n      editorView.updateState(newState);\n      onChange(defaultMarkdownSerializer.serialize(editorView.state.doc));\n    },\n  });\n\n  return editorView;\n};\n\nexport { createEditorView };\n","import React from 'react';\n\nconst Bold = () => (\n  <svg className=\"a-svg-icon a-svg-icon--bold\" viewBox=\"0 0 32 32\">\n    <path\n      d=\"M24.2,17.4c-0.9-0.9-2-1.7-3.3-2.1c1.8-1,3.6-3,3.6-6.7c0-0.1,0.2-3.5-2.1-5.9C20.8,0.9,18.5,0,15.5,0H9v0H7\n  v32h0.8v0H16c0.1,0,0.1,0,0.2,0c1.5,0,5.3-0.1,7.8-2.6c1.5-1.5,2.3-3.6,2.3-6.1C26.3,22.8,26.4,19.8,24.2,17.4z M15.5,2\n  c2.4,0,4.2,0.6,5.4,1.9c1.7,1.8,1.6,4.4,1.6,4.5c0,2.6-1,4.3-3,5.3c-1.1,0.5-2.4,0.8-4,0.8H9V2H15.5z M24.2,23.1l0,0.1\n  c0,2-0.6,3.6-1.7,4.8c-2,2-5.5,2-6.6,2H9V16.5h6.8c3.2-0.1,5.5,0.7,6.9,2.2C24.4,20.6,24.2,23.1,24.2,23.1z\"\n    />\n  </svg>\n);\n\nexport default Bold;\n","import React from 'react';\n\nconst Code = () => (\n  <svg className=\"a-svg-icon a-svg-icon--code\" viewBox=\"0 0 32 32\">\n    <polygon points=\"13.1,6.7 11.6,5.3 1,16 11.7,26.7 13.1,25.3 3.8,16 \" />\n    <polygon points=\"20.4,5.3 19,6.7 28.2,16 19,25.3 20.4,26.7 31,16 \" />\n  </svg>\n);\n\nexport default Code;\n","import React from 'react';\n\nconst CodeBlock = () => (\n  <svg viewBox=\"0 0 32 32\">\n    <path\n      fill=\"#3A343A\"\n      d=\"M11.97,1.02L10.69,1v0C10.47,1,8.7,0.85,7.48,1.96c-0.6,0.55-0.92,1.31-0.92,2.2v9.66  c0,0.42-0.15,0.6-0.27,0.72C5.77,15.06,3.97,15,3.97,15v2c0,0,1.79-0.07,2.33,0.46c0.12,0.12,0.27,0.3,0.27,0.72v9.66  c0,0.89,0.32,1.65,0.92,2.2C8.7,31.15,10.47,31,10.69,31v0l1.28-0.02V29L10.69,29c-0.33,0.02-1.38,0-1.86-0.44  c-0.12-0.11-0.27-0.3-0.27-0.72v-9.66c0-0.87-0.31-1.63-0.9-2.18c0.58-0.55,0.9-1.31,0.9-2.18V4.16c0-0.42,0.14-0.61,0.27-0.72  C9.31,2.99,10.36,2.97,10.69,3v0L11.97,3V1.02z\"\n    />\n    <path\n      fill=\"#3A343A\"\n      d=\"M19.98,1.02L21.26,1v0c0.22,0,1.99-0.15,3.21,0.97c0.6,0.55,0.92,1.31,0.92,2.2v9.66  c0,0.42,0.15,0.6,0.27,0.72c0.52,0.52,2.33,0.46,2.33,0.46v2c0,0-1.79-0.07-2.33,0.46c-0.12,0.12-0.27,0.3-0.27,0.72v9.66  c0,0.89-0.32,1.65-0.92,2.2C23.25,31.15,21.49,31,21.26,31v0l-1.28-0.02V29L21.26,29c0.33,0.02,1.38,0,1.86-0.44  c0.12-0.11,0.27-0.3,0.27-0.72v-9.66c0-0.87,0.31-1.63,0.9-2.18c-0.58-0.55-0.9-1.31-0.9-2.18V4.16c0-0.42-0.14-0.61-0.27-0.72  C22.64,2.99,21.59,2.97,21.26,3v0L19.98,3V1.02z\"\n    />\n  </svg>\n);\n\nexport default CodeBlock;\n","import React from 'react';\n\nconst Heading = () => (\n  <svg className=\"a-svg-icon a-svg-icon--heading\" viewBox=\"0 0 32 32\">\n    <polygon points=\"25,0 25,15 7,15 7,0 5,0 5,32 7,32 7,17 25,17 25,32 27,32 27,0 \" />\n  </svg>\n);\n\nexport default Heading;\n","import React from 'react';\n\nconst Image = () => (\n  <svg className=\"a-svg-icon a-svg-icon--italic\" viewBox=\"0 0 32 32\">\n    <circle cx=\"21.5\" cy=\"11.5\" r=\"4.5\" />\n    <polygon points=\"32,6 32,0 0,0 0,32 32,32 32,11 30,11 30,30 16,20 2,30 2,2 30,2 30,6\" />\n  </svg>\n);\n\nexport default Image;\n","import React from 'react';\n\nconst Italic = () => (\n  <svg className=\"a-svg-icon a-svg-icon--italic\" viewBox=\"0 0 32 32\">\n    <polygon points=\"25.3,2 25.3,0 13.3,0 13.3,2 18.1,2 12.2,30 7,30 7,32 19,32 19,30 14.2,30 20.1,2 \" />\n  </svg>\n);\n\nexport default Italic;\n","import React from 'react';\n\nconst OrderedList = () => (\n  <svg className=\"a-svg-icon a-svg-icon--ordered-list\" viewBox=\"0 0 32 32\">\n    <rect x=\"10\" y=\"3\" width=\"22\" height=\"2\" />\n    <rect x=\"10\" y=\"15\" width=\"22\" height=\"2\" />\n    <rect x=\"10\" y=\"27\" width=\"22\" height=\"2\" />\n    <path\n      d=\"M3.8,25.1c-1,0-1.3,0.8-1.3,0.8l-1.3-0.7c0,0,0.7-1.6,2.7-1.6c1.5,0,2.9,0.8,2.9,2.4c0,1.1-0.9,1.4-0.9,1.4\n    s1,0.4,1,1.7c0,1.6-1.4,2.4-2.9,2.4c-2.2,0-2.8-1.8-2.8-1.8l1.4-0.8c0,0,0.3,1.1,1.4,1.1c0.7,0,1-0.4,1-0.9c0-0.6-0.5-0.9-1.3-0.9\n    H3.3v-1.3h0.3c0.6,0,1.3-0.2,1.3-0.9C4.9,25.5,4.5,25.1,3.8,25.1z\"\n    />\n    <path\n      d=\"M4.1,16C4.4,15.6,5,15,5,14.3c0-0.6-0.5-1.1-1.2-1.1c-1,0-1.3,1.1-1.3,1.1L1,13.8c0,0,0.6-2.3,2.8-2.3\n    c2,0,3,1.4,3,2.7c0,0.8-0.4,1.5-0.6,1.7L4.7,18h2.2v1.6H1.1L4.1,16z\"\n    />\n    <path d=\"M4.4,0.6H6v7.9H4.2V2.9L2.4,4.5l-1-1.3L4.4,0.6z\" />\n  </svg>\n);\n\nexport default OrderedList;\n","import React from 'react';\n\nconst Quote = () => (\n  <svg className=\"a-svg-icon a-svg-icon--quote\" viewBox=\"0 0 32 32\">\n    <path d=\"M11.1,26V15.9H5.6C6,12.3,8.3,9.5,12,9.5V5.8c-5.8,0-10.5,4.4-11,10.1l0,0V26H11.1z\" />\n    <path d=\"M20.9,5.8v10.1h5.5c-0.5,3.6-2.7,6.4-6.4,6.4V26c5.8,0,10.5-4.4,11-10.1l0,0V5.8L20.9,5.8z\" />\n  </svg>\n);\n\nexport default Quote;\n","import React from 'react';\n\nconst UnorderedList = () => (\n  <svg className=\"a-svg-icon a-svg-icon--unordered-list\" viewBox=\"0 0 32 32\">\n    <circle cx=\"2.5\" cy=\"4\" r=\"2.5\" />\n    <circle cx=\"2.5\" cy=\"16\" r=\"2.5\" />\n    <circle cx=\"2.5\" cy=\"28\" r=\"2.5\" />\n    <rect x=\"8\" y=\"3\" width=\"24\" height=\"2\" />\n    <rect x=\"8\" y=\"15\" width=\"24\" height=\"2\" />\n    <rect x=\"8\" y=\"27\" width=\"24\" height=\"2\" />\n  </svg>\n);\n\nexport default UnorderedList;\n","import { Icons as IconsType } from '../types';\nimport Bold from './Bold';\nimport Code from './Code';\nimport CodeBlock from './CodeBlock';\nimport Heading from './Heading';\nimport Image from './Image';\nimport Italic from './Italic';\nimport OrderedList from './OrderedList';\nimport Quote from './Quote';\nimport UnorderedList from './UnorderedList';\n\nconst Icons: IconsType = {\n  Bold,\n  Code,\n  CodeBlock,\n  Heading,\n  Image,\n  Italic,\n  OrderedList,\n  Quote,\n  UnorderedList,\n};\n\nexport default Icons;\n","import React, { FunctionComponent } from 'react';\nimport { ToolbarItem } from '../types';\nimport classNames from 'classnames';\nimport Icons from '../Icons';\n\nconst Item: FunctionComponent<ToolbarItem> = ({\n  item,\n  item: { icon, name },\n  isActive,\n  onClick,\n}) => {\n  const Icon = Icons[icon];\n  return (\n    <button\n      className={classNames('item', { 'item--active': isActive })}\n      data-item={name}\n      onClick={() => onClick(item)}\n      type=\"button\"\n    >\n      <Icon />\n    </button>\n  );\n};\n\nexport default Item;\n","import React, { ChangeEvent } from 'react';\nimport { fileUpload } from '../Editor/Plugins/fileUpload';\nimport Icons from '../Icons';\n\nconst ImageUpload = ({\n  editor,\n  imageUploadEndpoint,\n  onError,\n}: {\n  editor: any;\n  imageUploadEndpoint: any;\n  onError: any;\n}) => {\n  const onImageUpload = (e: ChangeEvent) => {\n    if (!imageUploadEndpoint) return;\n    if (!editor) return;\n    if (!e.target) return;\n    const target = e.target as HTMLInputElement;\n    if (!target.files) return;\n\n    e.preventDefault();\n\n    fileUpload(\n      editor,\n      Array.from(target.files),\n      imageUploadEndpoint,\n      editor.state.tr.selection.from,\n      onError\n    );\n    editor.focus();\n    target.value = '';\n  };\n\n  return (\n    <div className=\"fileUploadWrapper\">\n      <input\n        type=\"file\"\n        accept=\".jpg,.jpeg,.png,.gif\"\n        onChange={onImageUpload}\n      />\n      <button data-item=\"image\" className=\"item fileUploadWrapper--button\">\n        <Icons.Image />\n      </button>\n    </div>\n  );\n};\n\nexport default ImageUpload;\n","import React, { useMemo } from 'react';\nimport Item from './Item';\nimport { FunctionComponent } from 'react';\nimport menuItems from './menuItems';\nimport { Toolbar as ToolbarType } from '../types';\nimport ImageUpload from './ImageUpload';\n\nconst Toolbar: FunctionComponent<ToolbarType> = ({\n  onClick,\n  activeOptions,\n  editor,\n  imageUploadEndpoint,\n  disabledItems = [],\n  onError,\n}) => {\n  const menuItemsToRender = useMemo(() => {\n    return menuItems(editor.state.schema).filter(\n      i => !disabledItems.includes(i.name)\n    );\n  }, [disabledItems, editor.state.schema]);\n\n  return (\n    <div className=\"toolbar\">\n      {menuItemsToRender.map(item => (\n        <Item\n          key={item.name}\n          item={item}\n          onClick={onClick}\n          isActive={activeOptions.includes(item.name)}\n        />\n      ))}\n\n      {!disabledItems.includes('image') && (\n        <ImageUpload\n          editor={editor}\n          imageUploadEndpoint={imageUploadEndpoint}\n          onError={onError}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default React.memo(Toolbar);\n","import React, { FunctionComponent } from 'react';\nimport { ContextualHelp as ContextualHelpType } from '../types';\n\nconst ContextualHelp: FunctionComponent<ContextualHelpType> = ({\n  activeOptions,\n}) => {\n  const helpText: { [key: string]: string } = {\n    code_block: 'Hold down shift and press enter to exit the code block',\n  };\n\n  return <p>{activeOptions.map(o => helpText[o])}</p>;\n};\n\nexport default ContextualHelp;\n","import React, {\n  FunctionComponent,\n  useEffect,\n  useRef,\n  useState,\n  useCallback,\n} from 'react';\nimport { MarkDownEditor as MarkDownEditorType, MenuItem } from './types';\nimport { createEditorView } from './Editor';\nimport { EditorView } from 'prosemirror-view';\nimport Toolbar from './Toolbar';\nimport './index.scss';\nimport classNames from 'classnames';\nimport ContextualHelp from './ContextualHelp';\n\nconst MarkDownEditor: FunctionComponent<MarkDownEditorType> = ({\n  id,\n  name,\n  onChange = () => {},\n  value = '',\n  placeholder = 'Enter text',\n  classes = '',\n  imageUploadEndpoint,\n  onError = () => {},\n  disabledMarks = [],\n  disabledNodes = [],\n  inputRef,\n}) => {\n  const editorRef = useRef<HTMLDivElement>(null);\n  const [editor, setEditor] = useState<EditorView | null>(null);\n  const [markdownValue, setMarkdownValue] = useState<string>(value);\n  const [activeOptions, setActiveOptions] = useState<string[]>([]);\n  const disabledItems = useRef([...disabledMarks, ...disabledNodes]);\n  const activeOptionsRef = useRef(activeOptions);\n\n  const onInputChange = (md: string) => {\n    setMarkdownValue(md);\n    onChange(md);\n  };\n\n  const onToolbarChange = (options: string[]) => {\n    if (JSON.stringify(options) !== JSON.stringify(activeOptionsRef.current)) {\n      setActiveOptions(options);\n    }\n  };\n\n  const initEditor = () => {\n    if (editorRef.current) {\n      const editorView = createEditorView({\n        node: editorRef.current,\n        value,\n        onChange: onInputChange,\n        classes,\n        placeholder,\n        onToolbarChange: onToolbarChange,\n        imageUploadEndpoint,\n        onError: onError,\n        disabledNodes,\n        disabledMarks,\n      });\n\n      setEditor(editorView);\n    }\n  };\n\n  const onToolbarClick = useCallback(\n    ({ command }: MenuItem) => {\n      if (editor) {\n        editor.focus();\n        command(editor.state, editor.dispatch, editor);\n      }\n    },\n    [editor]\n  );\n\n  useEffect(() => {\n    activeOptionsRef.current = activeOptions;\n  }, [activeOptions]);\n\n  useEffect(() => {\n    if (inputRef) {\n      inputRef.current = editor;\n    }\n  }, [editor]);\n\n  useEffect(() => {\n    if (value !== markdownValue && editor) {\n      editor.destroy();\n      initEditor();\n    }\n  }, [value]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => {\n    initEditor();\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return (\n    <>\n      {editor && (\n        <Toolbar\n          activeOptions={activeOptions}\n          onClick={onToolbarClick}\n          editor={editor}\n          disabledItems={disabledItems.current}\n          imageUploadEndpoint={imageUploadEndpoint}\n          onError={onError}\n        />\n      )}\n      <div\n        id={id}\n        className={classNames({ hasPlaceholder: !markdownValue.length })}\n        ref={editorRef}\n      />\n      <ContextualHelp activeOptions={activeOptions} />\n      <input\n        type=\"hidden\"\n        value={markdownValue}\n        onChange={() => {}}\n        name={name}\n      />\n    </>\n  );\n};\n\nexport default MarkDownEditor;\n"],"names":["Schema","nodes","doc","content","paragraph","group","parseDOM","tag","toDOM","blockquote","horizontal_rule","heading","attrs","level","defining","node","code_block","code","isolating","marks","params","preserveWhitespace","getAttrs","getAttribute","ordered_list","order","tight","dom","hasAttribute","start","bullet_list","list_item","text","image","src","alt","title","draggable","querySelector","hard_break","inline","selectable","em","style","value","strong","test","link","href","inclusive","IGNORED_NODES","IGNORED_TOKENS","MARKDOWN_IT_RULES","fence","hr","setupSchema","disabledMarks","disabledNodes","includes","push","initialSchema","omit","defaultMarkdownParser","schema","disabledTokens","tokens","initialDefaultMarkdownParser","md","markdownit","html","tokensToDisable","compact","map","t","disable","parser","MarkdownParser","tokenHandlers","paragraph_close","state","length","Mark","none","info","stack","pop","type","create","defaultMarkdownSerializer","initialDefaultMarkdownSerializer","write","textContent","ensureNewLine","closeBlock","EDITOR_CLASS","editorPlugin","classes","placeholder","Plugin","props","attributes","pastePlugin","onError","clipboardTextParser","fragment","parse","Slice","maxOpen","transformPastedHTML","getMarksBetween","end","nodesBetween","pos","mark","nodeSize","markInputRule","regexp","markType","InputRule","match","Function","tr","m","markEnd","markStart","matchStart","indexOf","matchEnd","textStart","lastIndexOf","textEnd","excludedMarks","filter","item","excludes","addMark","removeStoredMark","linkInputRule","insertText","markdownLinkInputRule","markIsActive","selection","from","$from","to","empty","isInSet","storedMarks","rangeHasMark","nodeIsActive","predicate","findSelectedNodeOfType","findParentNode","Object","keys","isActive","hasMarkup","toggleBlockType","toggletype","dispatch","setBlockType","toggleWrap","lift","wrapIn","isList","todo_list","toggleList","listType","itemType","$to","range","blockRange","parentList","depth","liftListItem","validContent","setNodeMarkup","wrapInList","Menu","items","editorView","onUpdate","markActive","NodeType","update","activeItems","i","name","destroy","menuPlugin","view","placeholderPlugin","init","DecorationSet","apply","set","mapping","action","getMeta","add","widget","document","createElement","className","loader","appendChild","deco","Decoration","id","remove","find","undefined","spec","decorations","getState","findPlaceholder","decos","found","fileUpload","images","endpoint","position","confirmResult","window","confirm","setMeta","setSelection","forEach","formData","FormData","append","xhr","XMLHttpRequest","withCredentials","open","url","setRequestHeader","csrfToken","onerror","transaction","onload","jsonBody","JSON","response","errors","status","data","replaceWith","send","imageDropPlugin","handleDOMEvents","drop","event","dragEvent","dataTransfer","hasFiles","files","Array","file","preventDefault","coordinates","posAtCoords","left","clientX","top","clientY","getDecorations","languages","blocks","findBlockNodes","parseNodes","properties","children","block","startPos","low","highlightAuto","language","relevance","flattenDeep","decoration","join","highlightPlugin","registerLanguage","javascript","python","r","css","java","key","PluginKey","_","decorationSet","oldState","nodeName","$head","parent","previousNodeName","docChanged","_view","prevState","highlight","get","lang","BaseType","getPlugins","_type","keymap","shortcuts","inputRules","rules","getToolbarItem","inToolbar","command","icon","_state","_dispatch","Strong","toggleMark","Emphasis","InlineCode","URL_REGEX","MARKDOWN_URL_REGX","Link","MARKS","plugins","flatMap","toolbarItems","Node","Blockquote","wrappingInputRule","LEVELS","Heading","paragraphType","l","textblockTypeInputRule","RegExp","BulletList","listItemType","OrderedList","childCount","CodeBlock","NODES","menuItems","markToolbarItems","nodeToolbarItems","createEditorView","onChange","onToolbarChange","imageUploadEndpoint","LIST_ITEM_TYPE","toggleBlockIfEmpty","history","undo","redo","Enter","splitListItem","Backspace","exitCode","baseKeymap","markPlugins","nodePlugins","EditorView","EditorState","dispatchTransaction","transation","newState","updateState","serialize","Bold","React","viewBox","d","Code","points","fill","Image","cx","cy","Italic","x","y","width","height","Quote","UnorderedList","Icons","Item","onClick","Icon","classNames","ImageUpload","editor","onImageUpload","e","target","focus","accept","Toolbar","activeOptions","disabledItems","menuItemsToRender","useMemo","memo","ContextualHelp","helpText","o","MarkDownEditor","inputRef","editorRef","useRef","useState","setEditor","markdownValue","setMarkdownValue","setActiveOptions","activeOptionsRef","onInputChange","options","stringify","current","initEditor","onToolbarClick","useCallback","useEffect","hasPlaceholder","ref"],"mappings":"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"}